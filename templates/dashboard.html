{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="challenge-header">
        <h2>Day {{ current_day }} of 75</h2>
        {% if current_day > 0 and current_day <= 75 %}
            <p class="challenge-date">Challenge started: {{ challenge.start_date.strftime('%B %d, %Y') }}</p>
        {% elif current_day == 0 %}
            <p class="challenge-date">Challenge starts: {{ challenge.start_date.strftime('%B %d, %Y') }}</p>
        {% else %}
            <p class="challenge-date">🎉 Challenge Complete! 🎉</p>
        {% endif %}
    </div>

    <div class="progress-section">
        <h3>Your Progress</h3>
        <div class="progress-bar-container">
            <div class="progress-bar" style="width: {{ progress_percentage }}%"></div>
        </div>
        <p class="progress-text">
            {{ completed_count }} of {{ total_possible }} goals completed ({{ "%.1f"|format(progress_percentage) }}%)
        </p>
        
        {% if progress_percentage >= 100 %}
            <div class="motivational-message success">
                🏆 Perfect score! You're absolutely crushing it! Keep this momentum going!
            </div>
        {% elif progress_percentage >= 75 %}
            <div class="motivational-message great">
                🌟 Excellent work! You're in the top tier - stay focused!
            </div>
        {% elif progress_percentage >= 50 %}
            <div class="motivational-message good">
                💪 Great effort! You're over halfway there - keep pushing!
            </div>
        {% elif progress_percentage >= 25 %}
            <div class="motivational-message okay">
                🔥 You're building momentum! Every day counts - let's go!
            </div>
        {% else %}
            <div class="motivational-message start">
                🚀 The journey begins now! You've got this - one day at a time!
            </div>
        {% endif %}
    </div>

    {% if current_day > 0 and current_day <= 75 %}
    <div class="daily-goals">
        <h3>Today's Goals</h3>
        <form class="goals-checklist">
            {% for goal in goals %}
            <div class="goal-item">
                <label>
                    <input type="checkbox" 
                           hx-post="/progress/toggle/{{ goal.id }}"
                           hx-target="this"
                           hx-swap="outerHTML"
                           {% if today_progress.get(goal.id) %}checked{% endif %}>
                    <span class="goal-text">{{ goal.goal_text }}</span>
                </label>
            </div>
            {% endfor %}
        </form>
    </div>
    {% elif current_day == 0 %}
    <div class="waiting-message">
        <h3>Get Ready!</h3>
        <p>The challenge hasn't started yet. Come back on {{ challenge.start_date.strftime('%B %d, %Y') }} to begin!</p>
        <p>Use this time to prepare and set your goals.</p>
    </div>
    {% else %}
    <div class="completion-message">
        <h3>🎉 Congratulations! 🎉</h3>
        <p>You've completed the 75 Hard Challenge!</p>
        <p>Your dedication and perseverance are truly inspiring!</p>
    </div>
    {% endif %}

    <div class="quick-links">
        <a href="{{ url_for('scoreboard') }}" class="btn btn-secondary">View Scoreboard</a>
        <a href="{{ url_for('manage_goals') }}" class="btn btn-secondary">Edit Goals</a>
    </div>
</div>
{% endblock %}
